<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html xml:lang="pt" > 
<head><title>Ajuste linear geral</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,3,notoc*,info --> 
<meta name="src" content="main.tex"> 
<meta name="date" content="2016-11-01 19:26:00"> 
<link rel="stylesheet" type="text/css" href="main.css"> 
<meta name='keywords' content='Livro, Cálculo Numérico, Métodos, Análise, Ajuste linear geral, Ajuste polinomial'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
  <link href='http://fonts.googleapis.com/css?family=Open Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../bootstrap-3.3.5-dist/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="new_main.css"> 
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="../bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>
</head>
<body>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61232881-2', 'auto');
  ga('send', 'pageview');
</script>

<div class="row">
  <div class="col-xs-12 col-xs-offset-0 col-md-8 col-md-offset-2">

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <a class="navbar-brand" href="#">Cálculo Numérico<br>Um Livro Colaborativo</a>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
			<li class="active"><a href="main.html">Menu do Livro</a></li>
			<li><a href="../index.html">Projeto</a></li>
			<li><a href="../colabore.html">Colabore</a></li>
			<li><a
				href="https://github.com/livroscolaborativos/CalculoNumerico"
				target="_blank">Repositório</a></li>
			<li><a href="../organizadores.html">Organizadores</a></li>
			<li><a href="../derivados.html">Trabalhos Derivados</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
   <!--l. 245--><div class="crosslinks"><p class="noindent"><a 
href="mainli11.html#mainli12.html" >Índice</a></p></div>
   <h3 class="sectionHead"><span class="titlemark">7.2   </span> <a 
 id="x70-1100007.2"></a>Ajuste linear geral</h3>
<a 
 id="dx70-110001"></a>
<!--l. 247--><p class="noindent" >O problem geral de ajuste linear consiste em dada uma família <img 
src="main3232x.png" alt="F "  class="math" > gerada pelo
conjunto de <img 
src="main3233x.png" alt="m  "  class="math" > funções <img 
src="main3234x.png" alt="{f1(x),f2(x),...,fm (x )} "  class="math" > e um conjunto de <img 
src="main3235x.png" alt="n  "  class="math" > pontos
<img 
src="main3236x.png" alt="{(x1,y1)  "  class="math" >, <img 
src="main3237x.png" alt="(x2,y2)  "  class="math" >, <img 
src="main3238x.png" alt="...  "  class="math" >, <img 
src="main3239x.png" alt="(xn,yn)} "  class="math" >, calcular os coeficientes <img 
src="main3240x.png" alt="a1   "  class="math" >, <img 
src="main3241x.png" alt="a2   "  class="math" >, <img 
src="main3242x.png" alt="...  "  class="math" >, <img 
src="main3243x.png" alt="am  "  class="math" >
tais que a função dada por
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3244x.png" alt="       &sum;m
f(x ) =    ajfj(x ) = a1f1(x) + a2f2 (x ) + ...+ amfm (x)
       j=1
" class="math-display" ></center></td></tr></table>
<!--l. 250--><p class="nopar" >
minimiza o resíduo
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3245x.png" alt="    &sum;n            2
R =     [f (xi) &minus; yi] .
     i=1
                                                                          

                                                                          
" class="math-display" ></center></td></tr></table>
<!--l. 254--><p class="nopar" >
Aqui, a minimização é feita por todas as possíveis escolhas dos coeficientes <img 
src="main3246x.png" alt="a1   "  class="math" >,
<img 
src="main3247x.png" alt="a2   "  class="math" >, <img 
src="main3248x.png" alt="...  "  class="math" >, <img 
src="main3249x.png" alt="am  "  class="math" >.
<!--l. 257--><p class="indent" >   Com o objetivo de tornar a desenvolvimento mais claro, vamos escrever <img 
src="main3250x.png" alt="R  "  class="math" >
como a soma dos resíduos parciais:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3251x.png" alt="     n
R = &sum;   R ,  onde   R  :=  [f (x ) &minus; y ]2 .
     i=1  i           i        i    i
" class="math-display" ></center></td></tr></table>
<!--l. 260--><p class="nopar" >
Do fato que <img 
src="main3252x.png" alt="        &sum;m
f(xi) =   j=1 ajfj(xi)  "  class="math" >, temos que cada resíduo pode ser escrito
como
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3253x.png" alt="      &lfloor;&sum;m             &rfloor; 2
Ri =  &lceil;   ajfj(xi) &minus; yi&rceil;  .
       j=1
" class="math-display" ></center></td></tr></table>
<!--l. 264--><p class="nopar" >
<!--l. 266--><p class="indent" >   A fim de encontrar o ponto de mínimo, resolvemos o sistema oriundo de
igualar a zero cada uma das derivadas parciais de <img 
src="main3254x.png" alt="R  "  class="math" > em relação aos <img 
src="main3255x.png" alt="m  "  class="math" >
                                                                          

                                                                          
coeficientes <img 
src="main3256x.png" alt="aj  "  class="math" >, i.e. devemos resolver: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main3257x.png" alt="            n           n &lfloor; m              &rfloor;
 &part;R-- =   2 &sum;  &part;Ri-=  2&sum;  &lceil; &sum;  a f (x ) &minus; y &rceil; f (x) = 0,
 &part;a1        i=1 &part;a1     i=1  j=1  j j  i    i   1  i
                          &lfloor;                &rfloor;
 &part;R         n&sum;  &part;Ri     &sum;n   m&sum;
 &part;a-- =   2    &part;a--=  2   &lceil;    ajfj(xi) &minus; yi&rceil; f2(xi) = 0,
   2        i=1   2     i=1  j=1
       ..
       .                   &lfloor;               &rfloor;
-&part;R--       n&sum;  &part;Ri--    n&sum;   &sum;m
&part;a    =   2    &part;a   = 2    &lceil;   ajfj(xi) &minus; yi&rceil; fm (xi) = 0.
   m        i=1   m      i=1  j=1
" class="math-display" ></center>
</div>
<!--l. 274--><p class="indent" >   Dividindo cada equação por 2 e escrevendo na forma matricial, obtemos
<img 
src="main3258x.png" alt="M  a = w  "  class="math" >, onde a matriz <img 
src="main3259x.png" alt="M  "  class="math" > é dada por: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main3260x.png" alt="      &lfloor;   &sum;n       2     n&sum;                     n&sum;              &rfloor;
      |   i=1f1(xi)      i=1 f2(xi)f1(xi)   &sdot;&sdot;&sdot;  i=1 fm(xi)f1(xi)|
      || &sum;n                 &sum;n       2          n&sum;              ||
      ||    f1(xi)f2(xi)        f2(xi)      &sdot;&sdot;&sdot;     fm(xi)f2(xi)||
      || i=&sum;1n               n&sum; i=1                 i=n&sum;1             ||
M  =  ||    f1(xi)f3(xi)      f2(xi)f3(xi)   &sdot;&sdot;&sdot;     fm(xi)f3(xi)||.
      || i=1     .         i=1     .         .    i=1     .       ||
      ||        ..                ..          ..         ..       ||
      |&lceil; n&sum;                n&sum;                       &sum;n       2   |&rceil;
          f1 (xi)fm (xi)    f2(xi)fm (xi)   &sdot;&sdot;&sdot;       fm (xi)
       i=1              i=1                      i=1
" class="math-display" ></center>
</div>E os vetores <img 
src="main3261x.png" alt="a  "  class="math" > e <img 
src="main3262x.png" alt="w  "  class="math" >, por: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main3263x.png" alt="                          &lfloor;  &sum;n          &rfloor;
    &lfloor;     &rfloor;               |     f1(xi)yi |
       a1                 ||  i=&sum;1n          ||
    ||     ||               ||     f2(xi)yi ||
    ||  a2 ||               ||  i=&sum;1n          ||
a = ||  .  ||     e     w = ||     f3(xi)yi ||
    ||  ..  ||               ||  i=1   .      ||
    &lceil;     &rceil;               ||       ..      ||
      am                  |&lceil;  n&sum;           |&rceil;
                                fm(xi)yi
                             i=1
" class="math-display" ></center>
</div>
<!--l. 303--><p class="indent" >   Agora, observamos que <img 
src="main3264x.png" alt="M  = V TV  "  class="math" > e <img 
src="main3265x.png" alt="w =  V Ty  "  class="math" >, onde a matriz <img 
src="main3266x.png" alt="V  "  class="math" > é dada
por:
   <table 
class="equation-star"><tr><td>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main3267x.png" alt="     &lfloor;                            &rfloor;
     | f1(x1)  f2(x1)  &sdot;&sdot;&sdot;  fm(x1)|
     ||                            ||
     || f1(x2)  f2(x2)  &sdot;&sdot;&sdot;  fm(x2)||
V  = || f (x )  f (x )  &sdot;&sdot;&sdot;  f (x )||
     ||  1  3    2  3         m  3 ||
     ||   ...       ...     ...     ...  ||
     |&lceil;                            |&rceil;
       f1(xn )  f2(xn )  &sdot;&sdot;&sdot;  fm(xn)
" class="math-display" ></center></td></tr></table>
<!--l. 312--><p class="nopar" >
e é o vetor coluna <img 
src="main3268x.png" alt="y = (y1,y2,...,yN)  "  class="math" >,
<!--l. 315--><p class="indent" >   Então, o problema de ajuste se reduz a resolver o sistema linear <img 
src="main3269x.png" alt="M a = w  "  class="math" >, ou
<img 
src="main3270x.png" alt="V TV a = V Ty  "  class="math" >. Este sistema linear tem solução única se a matriz <img 
src="main3271x.png" alt="M  "  class="math" > for inversível.
O teorema a seguir mostra que isto acontece sempre a matriz <img 
src="main3272x.png" alt="V  "  class="math" > possui posto
<img 
src="main3273x.png" alt="m  "  class="math" >, ou seja, o número de linhas linearmente independentes for igual ao número de
colunas.<span class="footnote-mark"><a 
href="main71.html#fn1x10"><sup class="textsuperscript">1</sup></a></span><a 
 id="x70-110005f1"></a> 
   <div class="newtheorem">
<!--l. 318--><p class="noindent" ><span class="head">
<a 
 id="x70-110006r1"></a>
<span 
class="ec-lmbx-12">Teorema 7.2.1.</span>  </span><span 
class="ec-lmri-12">A  matriz</span>  <img 
src="main3274x.png" alt="M  = V TV  "  class="math" >  <span 
class="ec-lmri-12">é  quadrada  de  ordem</span>  <img 
src="main3275x.png" alt="m  "  class="math" >  <span 
class="ec-lmri-12">e  </span><span 
class="ec-lmri-12">é</span>
<span 
class="ec-lmri-12">invers</span><span 
class="ec-lmri-12">ível sempre que o posto da matriz</span> <img 
src="main3276x.png" alt="V  "  class="math" > <span 
class="ec-lmri-12">é igual a n</span><span 
class="ec-lmri-12">úmero de colunas</span> <img 
src="main3277x.png" alt="m  "  class="math" ><span 
class="ec-lmri-12">.</span>
   </div>
<!--l. 321--><p class="indent" >
   <div class="proof">
<!--l. 322--><p class="indent" >   <span class="head">
<span 
class="ec-lmri-12">Demonstra</span><span 
class="ec-lmri-12">ç</span><span 
class="ec-lmri-12">ão.</span> </span>Para provar que <img 
src="main3278x.png" alt="M  "  class="math" > é inversível, precisamos mostrar que
                                                                          

                                                                          
se <img 
src="main3279x.png" alt="v  "  class="math" > é um vetor de ordem <img 
src="main3280x.png" alt="m  "  class="math" > e <img 
src="main3281x.png" alt="M v = 0  "  class="math" >, então <img 
src="main3282x.png" alt="v =  0  "  class="math" >. Suponha, então,
que <img 
src="main3283x.png" alt="M  v = 0  "  class="math" >, isto é, <img 
src="main3284x.png" alt=" T
V  Vv =  0  "  class="math" >. Tomando o produto interno da expressão
<img 
src="main3285x.png" alt="  T
V  V v = 0  "  class="math" > com <img 
src="main3286x.png" alt="v  "  class="math" >, temos:
   <center class="math-display" >
<img 
src="main3287x.png" alt="    &#x27E8;        &#x27E9;
0 =  V TV v,v  = &#x27E8;V v,V v&#x27E9; = &#x2225;V v&#x2225;2
" class="math-display" ></center> Portato <img 
src="main3288x.png" alt="M  v = 0  "  class="math" > implica obrigatoriamente <img 
src="main3289x.png" alt="V v = 0  "  class="math" >. Como o posto de <img 
src="main3290x.png" alt="V  "  class="math" >
é igual ao número de colunas, <img 
src="main3291x.png" alt="v  "  class="math" > precisar ser o vetor nulo.                    __
   </div>
   <div class="newtheorem">
<!--l. 335--><p class="noindent" ><span class="head">
<a 
 id="x70-110007r1"></a>
<span 
class="ec-lmbx-12">Observa</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão 7.2.1.</span>  </span>Este problema é equivalente a resolver pelo métodos dos
mínimos quadrados o seguinte sistema linear:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3292x.png" alt="&lfloor;                            &rfloor;         &lfloor;   &rfloor;
                               &lfloor;   &rfloor;
||f1(x1)  f2(x1)  &sdot;&sdot;&sdot;  fm (x1)||         || y1||
||f (x )  f (x )  &sdot;&sdot;&sdot;  f  (x )|| ||a1 ||   || y ||
|| 1  2    2  2         m   2 || ||a  ||   ||  2||
||f1(x3)  f2(x3)  &sdot;&sdot;&sdot;  fm (x3)|| ||  2|| = || y3||
||   .       .            .   || || ... ||   ||  .||
||   ..       ..    ...     ..   || &lceil;   &rceil;   ||  ..||
&lceil;                            &rceil;  am     &lceil;   &rceil;
 f1(xn)  f2(xn)  &sdot;&sdot;&sdot;  fm (xn)            yn
" class="math-display" ></center></td></tr></table>
<!--l. 357--><p class="nopar" >
   </div>
<!--l. 360--><p class="indent" >   O caso de ajuste de um reta para um conjunto de pontos é um caso particular
de ajuste linear.
<!--l. 362--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x70-1100082"></a>
                                                                          

                                                                          
<!--l. 364--><p class="noindent" ><img 
src="main3293x.png" alt="PIC" class="graphics" width="215.80624pt" height="218.81749pt" ><!--tex4ht:graphics  
name="main3293x.png" src="cap_ajuste/pics/ex_ajuste_reta2/ex_ajuste_reta2.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figura&#x00A0;7.2: </span><span  
class="content">Gráfico da solução do problema apresentado no Exemplo&#x00A0;<a 
href="#x70-110009r1">7.2.1<!--tex4ht:ref: ex:ajuste_reta2 --></a>.</span></div><!--tex4ht:label?: x70-1100082 -->
                                                                          

                                                                          
<!--l. 367--><p class="indent" >   </div><hr class="endfigure">
   <div class="newtheorem">
<!--l. 369--><p class="noindent" ><span class="head">
<a 
 id="x70-110009r1"></a>
<span 
class="ec-lmbx-12">Exemplo 7.2.1.</span>  </span> Encontre a reta que melhor se ajusta aos pontos dados na
seguinte tabela:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3294x.png" alt="    |
    |
-i--|-1-----2-----3-----4-----5----
 x  |0,01  1,02  2,04  2,95   3,55
  i |
 yi |1,99  4,55  7,20  9,51  10,82
" class="math-display" ></center></td></tr></table>
<!--l. 376--><p class="nopar" >
   </div>
<!--l. 378--><p class="indent" >
   <div class="proof">
<!--l. 378--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> O problema consiste em ajustar uma função da forma
<img 
src="main3295x.png" alt="f (x ) = a1 + a2x  "  class="math" > no conjunto de pontos dados. Notamos que <img 
src="main3296x.png" alt="f (x )  "  class="math" > é uma
função da família gerada pelo conjunto de funções <img 
src="main3297x.png" alt="{f1(x) = 1,f2(x) = x } "  class="math" >.
Então, aplicando o procedimento acima, temos que o vetor dos coeficientes
<img 
src="main3298x.png" alt="a = (a1,a2)  "  class="math" > é solução por mínimos quadrados do sistema linear <img 
src="main3299x.png" alt="V a = y  "  class="math" >,
onde:
   <table 
class="equation-star"><tr><td>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main3300x.png" alt="     &lfloor;               &rfloor;   &lfloor;       &rfloor;
     | f1(x1)  f2(x1 )|   |1  0,01|
     ||               ||   ||       ||
     || f1(x2)  f2(x2 )||   ||1  1,02||
V  = || f (x )  f (x  )||=  ||1  2,04|| .
     ||  1  3    2  3 ||   ||       ||
     || f1(x4)  f2(x4 )||   ||1  2,95||
     |&lceil;               |&rceil;   |&lceil;       |&rceil;
       f1(x5)  f2(x5 )     1  3,55
" class="math-display" ></center></td></tr></table>
<!--l. 395--><p class="nopar" >
Ou seja, é a solução do sistema <img 
src="main3301x.png" alt="  T        T
V  V a = V  y  "  class="math" > dado por
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3302x.png" alt="&lfloor;             &rfloor; &lfloor;   &rfloor;   &lfloor;        &rfloor;
|  5     9,57  | | a1|   |  34,07 |
&lceil;             &rceil; &lceil;   &rceil; = &lceil;        &rceil;
 9,57  26,5071    a2      85,8144
" class="math-display" ></center></td></tr></table>
<!--l. 410--><p class="nopar" >
A solução desse sistema é <img 
src="main3303x.png" alt="a  = 1,9988251
  1  "  class="math" > e <img 
src="main3304x.png" alt="a  = 2,5157653
 2  "  class="math" >. A Figura&#x00A0;<a 
href="#x70-1100082">7.2<!--tex4ht:ref: fig:ex_ajuste_reta2 --></a>,
apresenta um gráfico dos pontos e da reta ajustada.
                                                                       <img 
src="main3305x.png" alt="&#x2662; "  class="math" >
   </div>
<!--l. 429--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x70-1100103"></a>
                                                                          

                                                                          
<!--l. 431--><p class="noindent" ><img 
src="main3306x.png" alt="PIC" class="graphics" width="213.79874pt" height="206.77249pt" ><!--tex4ht:graphics  
name="main3306x.png" src="cap_ajuste/pics/ex_ajuste_linear/ex_ajuste_linear.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figura&#x00A0;7.3: </span><span  
class="content">Gráfico da solução do problema apresentado no Exemplo&#x00A0;<a 
href="#x70-110011r2">7.2.2<!--tex4ht:ref: ex:ajuste_linear --></a>.</span></div><!--tex4ht:label?: x70-1100103 -->
                                                                          

                                                                          
<!--l. 434--><p class="indent" >   </div><hr class="endfigure">
   <div class="newtheorem">
<!--l. 437--><p class="noindent" ><span class="head">
<a 
 id="x70-110011r2"></a>
<span 
class="ec-lmbx-12">Exemplo 7.2.2.</span>  </span> Encontre a função <img 
src="main3307x.png" alt="f (x) = a1sen (&pi;x) + a2cos(&pi;x )  "  class="math" > que
melhor se ajusta pelo critérios dos mínimos quadrados aos seguintes pontos
dados
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3308x.png" alt="    |
 i  |  1     2     3     4     5
----|------------------------------
 xi |0,00   0,25   0,50  0,75  1,00
    |
 yi |&minus; 153   64   242   284   175
" class="math-display" ></center></td></tr></table>
<!--l. 444--><p class="nopar" >
   </div>
<!--l. 446--><p class="indent" >
   <div class="proof">
<!--l. 446--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> Pelo procedimento visto nesta seção, temos que os coeficientes <img 
src="main3309x.png" alt="a
  1   "  class="math" > e
<img 
src="main3310x.png" alt="a2   "  class="math" > são dados pela solução por mínimos quadrados do seguinte sistema linear
<img 
src="main3311x.png" alt="V a = y  "  class="math" >
   <table 
class="equation-star"><tr><td>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main3312x.png" alt="a1 sen (&pi;x1 ) + a2 cos(&pi;x1 ) = y1
a1 sen (&pi;x2 ) + a2 cos(&pi;x2 ) = y2

a1 sen (&pi;x3 ) + a2 cos(&pi;x3 ) = y3
a1 sen (&pi;x4 ) + a2 cos(&pi;x4 ) = y4
a  sen (&pi;x  ) + a cos(&pi;x  ) = y
 1        5    2       5     5
" class="math-display" ></center></td></tr></table>
<!--l. 456--><p class="nopar" >
cuja matriz de coeficientes <img 
src="main3313x.png" alt="V  "  class="math" > é:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3314x.png" alt="     &lfloor;                      &rfloor;
         sin(0)      cos(0)
     ||                      ||
     || sin(0,25&pi;)  cos(0,25&pi;)||
     ||                      ||
     || sin(0,5 &pi;)   cos(0,5 &pi;)||
V =  ||                      ||
     || sin(0,75&pi;)  cos(0,75&pi;)||
     ||   sin(&pi;)      cos(&pi;)  ||
     |&lceil;                      |&rceil;
" class="math-display" ></center></td></tr></table>
<!--l. 466--><p class="nopar" >
<!--l. 468--><p class="indent" >   Então, a solução por mínimos quadrados é
                                                                          

                                                                          
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3315x.png" alt="                     &lfloor;           &rfloor;

a = (V TV )&minus;1V Ty =  |&lceil; 244,03658 |&rceil; .
                      &minus; 161,18783
" class="math-display" ></center></td></tr></table>
<!--l. 475--><p class="nopar" >
Ou seja, <img 
src="main3316x.png" alt="f(x) = 244,03658 sen (&pi;x) &minus; 161,18783 cos(&pi;x)  "  class="math" > é a função ajustada ao
conjunto de pontos dados. A Figura&#x00A0;<a 
href="#x70-1100103">7.3<!--tex4ht:ref: fig:ex_ajuste_linear --></a> apresenta o gráfica de <img 
src="main3317x.png" alt="f(x )  "  class="math" > e dos pontos
dados.
<!--l. 479--><p class="indent" >   No <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">Scilab</span></span></span>, podemos computar os coeficientes da função <img 
src="main3318x.png" alt="f(x)  "  class="math" > da seguinte
forma:
                                                                          

                                                                          
   <div class="verbatim" id="verbatim-47">
--&#x003E;xi&#x00A0;=&#x00A0;[0&#x00A0;0.25&#x00A0;0.5&#x00A0;0.75&#x00A0;1]&#8217;;
&#x00A0;<br />--&#x003E;yi&#x00A0;=&#x00A0;[-153&#x00A0;64&#x00A0;242&#x00A0;284&#x00A0;175]&#8217;;
&#x00A0;<br />--&#x003E;V&#x00A0;=&#x00A0;[sin(%pi*xi)&#x00A0;cos(%pi*xi)];
&#x00A0;<br />--&#x003E;a&#x00A0;=&#x00A0;inv(V&#8217;*V)*V&#8217;*yi
&#x00A0;<br />&#x00A0;a&#x00A0;&#x00A0;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;244.03658
&#x00A0;<br />&#x00A0;&#x00A0;-&#x00A0;161.18783
</div>
<!--l. 488--><p class="nopar" >
                                                                       <img 
src="main3319x.png" alt="&#x2662; "  class="math" >
   </div>
   <div class="newtheorem">
<!--l. 508--><p class="noindent" ><span class="head">
<a 
 id="x70-110012r2"></a>
<span 
class="ec-lmbx-12">Observa</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão 7.2.2.</span>  </span>No <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">Scilab</span></span></span>, quando resolvemos um sistema <img 
src="main3320x.png" alt="Ax  = b  "  class="math" >
usando
                                                                          

                                                                          
   <div class="verbatim" id="verbatim-48">
--&#x003E;x&#x00A0;=&#x00A0;inv(A)*b
</div>
<!--l. 512--><p class="nopar" >estamos computando a inversa da matriz <img 
src="main3321x.png" alt="A  "  class="math" > e multiplicando por <img 
src="main3322x.png" alt="b  "  class="math" >. Podemos
evitar a computação da inversa de <img 
src="main3323x.png" alt="A  "  class="math" > usando o operador contra-barra (<img 
src="main3324x.png" alt="&#x2215;  "  class="math" >).
Neste caso, escrevemos
                                                                          

                                                                          
   <div class="verbatim" id="verbatim-49">
--&#x003E;x&#x00A0;=&#x00A0;A/b
</div>
<!--l. 516--><p class="nopar" >Quando o sistema <img 
src="main3325x.png" alt="A  "  class="math" > não é uma matriz quadrada, <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">A/b</span></span></span> retorna a solução por
mínimos quadrados do sistema <img 
src="main3326x.png" alt="Ax =  b  "  class="math" >, enquanto <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">inv(A)*b</span></span></span> retorna um erro,
pois <img 
src="main3327x.png" alt="A  "  class="math" > não é uma matriz quadrada e, portanto, não é invertível.
   </div>
   <h4 class="subsectionHead"><span class="titlemark">7.2.1   </span> <a 
 id="x70-1110007.2.1"></a>Ajuste polinomial</h4>
<a 
 id="dx70-111001"></a>
<!--l. 584--><p class="noindent" >O <span 
class="ec-lmbx-12">ajuste polinomial </span>é o caso particular do ajuste linear para <span 
class="ec-lmbx-12">fun</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ões</span>
<span 
class="ec-lmbx-12">polinomiais</span>, isto é, funções do tipo
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3328x.png" alt="                            m&minus;1
p(x) = a1 + a2x + &sdot;&sdot;&sdot; + amx    .
" class="math-display" ></center></td></tr></table>
<!--l. 587--><p class="nopar" >
<!--l. 589--><p class="indent" >   Neste caso, a matriz <img 
src="main3329x.png" alt="V  "  class="math" > associada ao ajuste dos pontos <img 
src="main3330x.png" alt="{(x1,y1)  "  class="math" >, <img 
src="main3331x.png" alt="(x2, y2)  "  class="math" >,
<img 
src="main3332x.png" alt="(x ,y )
  3  3  "  class="math" >, <img 
src="main3333x.png" alt="...  "  class="math" >, <img 
src="main3334x.png" alt="(x ,y )}
  n  n "  class="math" > é dada por:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
                                                                          

                                                                          
<img 
src="main3335x.png" alt="     &lfloor;                   m&minus;1&rfloor;
     | 1  x1  x21  &sdot;&sdot;&sdot;  x 1  |
     ||         2         m&minus;1||
     || 1  x2  x2  &sdot;&sdot;&sdot;  x 2  ||
V  = ||         2         m&minus;1||
     || 1  x3  x3  &sdot;&sdot;&sdot;  x 3  ||
     || ...   ...       ...    ...  ||
     |&lceil;                      |&rceil;
       1  xn  x2n  &sdot;&sdot;&sdot;  xmn&minus;1
" class="math-display" ></center></td></tr></table>
<!--l. 599--><p class="nopar" >
Então, os coeficientes <img 
src="main3336x.png" alt="ai  "  class="math" >, <img 
src="main3337x.png" alt="i = 1,2, ...,m  "  class="math" >, são dados pela solução do sistema
linear <img 
src="main3338x.png" alt="V T Va =  vTy  "  class="math" >:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3339x.png" alt="&lfloor;            n            n      &rfloor;           &lfloor;    n      &rfloor;
     n      &sum;  xj  &sdot;&sdot;&sdot;   &sum;  xm &minus;1  &lfloor;     &rfloor;       &sum;  yj
||           j=1          j=1  j   || |  a1 |   ||   j=1     ||
||  &sum;n       &sum;n  2         &sum;n  m  || ||     ||   ||  &sum;n       ||
||  j=1xj    j=1xj         j=1 xj  || ||  a2 ||   ||  j=1xjyj  ||
||    ..              ..      ..    || ||  ..  || = ||     ..     ||
||    .               .      .    || |&lceil;  .  |&rceil;   ||     .     ||
|&lceil; n&sum;   m&minus; 1  n&sum;   m        n&sum;   2m&minus;1|&rceil;  a        |&lceil; n&sum;   m&minus; 1  |&rceil;
 j=1 xj    j=1 xj  &sdot;&sdot;&sdot;  j=1x j     &#x25DF;-&#x25DD;p+&#x25DC;1-&#x25DE;     j=1 xj   yj
&#x25DF;---------------&#x25DD;&#x25DC;----------------&#x25DE;   a      &#x25DF;-----&#x25DD;&#x25DC;-----&#x25DE;
               V TV                               VTy
" class="math-display" ></center></td></tr></table>
<!--l. 620--><p class="nopar" >
<!--l. 622--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                          

                                                                          
<a 
 id="x70-1110024"></a>
                                                                          

                                                                          
<!--l. 624--><p class="noindent" ><img 
src="main3340x.png" alt="PIC" class="graphics" width="213.79874pt" height="203.76125pt" ><!--tex4ht:graphics  
name="main3340x.png" src="cap_ajuste/pics/ex_ajuste_polinomial/ex_ajuste_polinomial.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figura&#x00A0;7.4: </span><span  
class="content">Gráfico da solução do problema apresentado no Exemplo&#x00A0;<a 
href="#x70-111003r3">7.2.3<!--tex4ht:ref: ex:ajuste_polinomial --></a>.</span></div><!--tex4ht:label?: x70-1110024 -->
                                                                          

                                                                          
<!--l. 627--><p class="indent" >   </div><hr class="endfigure">
   <div class="newtheorem">
<!--l. 630--><p class="noindent" ><span class="head">
<a 
 id="x70-111003r3"></a>
<span 
class="ec-lmbx-12">Exemplo 7.2.3.</span>  </span> Entre o polinômio de grau 2 que melhor se ajusta aos pontos
dados na seguinte tabela:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3341x.png" alt="    |
-i--|--1-----2-----3-----4-----5---
    |
 xi |0,00   0,25   0,50  0,75  1,00
 y  |&minus; 153   64   242   284   175
  i
" class="math-display" ></center></td></tr></table>
<!--l. 637--><p class="nopar" >
   </div>
<!--l. 639--><p class="indent" >
   <div class="proof">
<!--l. 639--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> Um polinômio de grau 2 pode ser escrito na seguinte forma:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
                                                                          

                                                                          
<img 
src="main3342x.png" alt="                     2
p(x) = a1 + a2x + a3x .
" class="math-display" ></center></td></tr></table>
<!--l. 643--><p class="nopar" >
Assim, o problema se resume em encontrarmos a solução por mínimos quadrados
do seguinte sistema linear:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3343x.png" alt="                2
a1 + a2x1 + a3x 1 = y1
a2 + a2x2 + a3x2 =  y2
                22
a3 + a2x3 + a3x 3 = y3
a4 + a2x4 + a3x24 = y4
                2
a5 + a2x5 + a3x 5 = y5
" class="math-display" ></center></td></tr></table>
<!--l. 653--><p class="nopar" >
Ou, escrita na forma matricial, <img 
src="main3344x.png" alt="V a = y  "  class="math" >, onde:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3345x.png" alt="      &lfloor;         &rfloor;
               2
      ||1  x1  x1||
      ||1  x   x2||
      ||    2   2||
V  =  ||1  x3  x2||
      ||        3||
      ||1  x4  x24||
      &lceil;         &rceil;
       1  x5  x25
" class="math-display" ></center></td></tr></table>
<!--l. 664--><p class="nopar" >
<!--l. 666--><p class="indent" >   A solução por mínimos quadrados é, então:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3346x.png" alt="                    &lfloor;            &rfloor;
                    |&minus; 165,37143 |
      T   &minus; 1 T     ||            ||
a = (V  V )  V  y = || 1250,9714  ||
                    &lceil;            &rceil;
                     &minus; 900,57143
" class="math-display" ></center></td></tr></table>
<!--l. 674--><p class="nopar" >
Ou seja, o polinômio de grau 2 que melhor ajusta os pontos dados no sentido de
mínimos quadrados é <img 
src="main3347x.png" alt="                                              2
p (x ) = &minus; 165,37143 + 1250,9714x &minus; 900,57143x   "  class="math" >. A
Figura&#x00A0;<a 
href="#x70-1110024">7.4<!--tex4ht:ref: fig:ex_ajuste_polinomial --></a> mostra o gráfico do polinômio ajustado e os pontos dados.
<!--l. 678--><p class="indent" >   No <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">Scilab</span></span></span>, podemos computar o polinômio <img 
src="main3348x.png" alt="p(x )  "  class="math" > da seguinte forma:
                                                                          

                                                                          
   <div class="verbatim" id="verbatim-50">
--&#x003E;xi&#x00A0;=&#x00A0;[0&#x00A0;0.25&#x00A0;0.5&#x00A0;0.75&#x00A0;1]&#8217;;
&#x00A0;<br />--&#x003E;yi&#x00A0;=&#x00A0;[-153&#x00A0;64&#x00A0;242&#x00A0;284&#x00A0;175]&#8217;;
&#x00A0;<br />--&#x003E;V&#x00A0;=&#x00A0;[ones(5,1)&#x00A0;xi&#x00A0;xi.^2];
&#x00A0;<br />--&#x003E;a&#x00A0;=&#x00A0;V\yi;
&#x00A0;<br />--&#x003E;p&#x00A0;=&#x00A0;poly(a,&#8217;x&#8217;,&#8217;c&#8217;)
&#x00A0;<br />&#x00A0;p&#x00A0;&#x00A0;=
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />&#x00A0;&#x00A0;-&#x00A0;165.37143&#x00A0;+&#x00A0;1250.9714x&#x00A0;-&#x00A0;900.57143x
</div>
<!--l. 688--><p class="nopar" >Para fazermos o gráfico do polinômio e dos pontos, digitamos:
                                                                          

                                                                          
   <div class="verbatim" id="verbatim-51">
--&#x003E;xx&#x00A0;=&#x00A0;linspace(-0.25,1.25);
&#x00A0;<br />--&#x003E;plot(xi,yi,&#8217;ro&#8217;,xx,horner(p,xx),&#8217;b-&#8217;);xgrid
</div>
<!--l. 693--><p class="nopar" >                                                                       <img 
src="main3349x.png" alt="&#x2662; "  class="math" >
   </div>
   <h4 class="likesubsectionHead"><a 
 id="x70-1120007.2.1"></a>Exercícios</h4>
   <div class="newtheorem">
<!--l. 756--><p class="noindent" ><span class="head">
<a 
 id="x70-112001r1"></a>
<span 
class="ec-lmbx-12">E 7.2.1.</span>  </span>Encontre o polinômio <img 
src="main3350x.png" alt="p(x ) = a1 + a2x + a3x2   "  class="math" > que melhor se ajusta no
sentido de mínimos quadrados aos pontos:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3351x.png" alt="   |
   |
-i-|---1------2------3-----4---
   |
 xi|&minus; 1,50  &minus; 0,50  1,25   1,50
 y | 1,15   &minus; 0,37  0,17   0,94
  i
" class="math-display" ></center></td></tr></table>
<!--l. 764--><p class="nopar" >
                                                                          

                                                                          
   </div>
<!--l. 766--><p class="noindent" >
   <div class="proof">
<!--l. 766--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Resposta.</span> </span> <img 
src="main3352x.png" alt="a1 = &minus;0,1946029  "  class="math" ><span 
class="ec-lmr-6">,</span> <img 
src="main3353x.png" alt="a2 =0,585986  "  class="math" ><span 
class="ec-lmr-6">,</span> <img 
src="main3354x.png" alt="a3 = &minus;0,0112599  "  class="math" ><span 
class="ec-lmr-6">.</span>
                                                                       <img 
src="main3355x.png" alt="&#x2662; "  class="math" >
   </div>
   <div class="newtheorem">
<!--l. 772--><p class="noindent" ><span class="head">
<a 
 id="x70-112002r2"></a>
<span 
class="ec-lmbx-12">E 7.2.2.</span>  </span>Encontrar a parábola <img 
src="main3356x.png" alt="y =  ax2 + bx + c  "  class="math" > que melhor aproxima o seguinte
conjunto de dados:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3357x.png" alt="    |
 i  | 1     2     3     4     5
----|------------------------------
 xi |0,01  1,02  2,04  2,95   3,55
    |
 yi  1,99  4,55  7,20  9,51  10,82
" class="math-display" ></center></td></tr></table>
<!--l. 779--><p class="nopar" >
   </div>
<!--l. 781--><p class="noindent" >
   <div class="proof">
<!--l. 781--><p class="indent" >   <span class="head">
                                                                          

                                                                          
<span 
class="ec-lmbx-12">Resposta.</span> </span> <img 
src="main3358x.png" alt="y =&minus;0,0407898x2+2,6613293x+1,9364598  "  class="math" ><span 
class="ec-lmr-6">.</span>
                                                                       <img 
src="main3359x.png" alt="&#x2662; "  class="math" >
   </div>
   <div class="newtheorem">
<!--l. 787--><p class="noindent" ><span class="head">
<a 
 id="x70-112003r3"></a>
<span 
class="ec-lmbx-12">E 7.2.3.</span>  </span>Dado o seguinte conjunto de dados
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main3360x.png" alt="    |
    |
-xi-|0,0--0,1--0,2--0,3--0,4--0,5--0,6--0,7--0,8--0,9--1,0--
    |
 yi  31   35   37  33   28   20   16  15   18   23   31
" class="math-display" ></center></td></tr></table>
<!--l. 793--><p class="nopar" >
      <ul class="itemize1">
      <li class="itemize">Encontre  a  função  do  tipo  <img 
src="main3361x.png" alt="f(x) = a + b sin(2&pi;x ) + ccos(2&pi;x )  "  class="math" >  que
      melhor aproxima os valores dados.
      </li>
      <li class="itemize">Encontre  a  função  do  tipo  <img 
src="main3362x.png" alt="                  2      3
f(x) = a + bx + cx  + dx   "  class="math" >  que  melhor
      aproxima os valores dados.</li></ul>
                                                                          

                                                                          
   </div>
<!--l. 799--><p class="noindent" >
   <div class="proof">
<!--l. 799--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Resposta.</span> </span> <span 
class="ec-lmr-6">a)</span> <img 
src="main3363x.png" alt="a= 25,638625  "  class="math" ><span 
class="ec-lmr-6">,</span> <img 
src="main3364x.png" alt="b=9,8591874  "  class="math" ><span 
class="ec-lmr-6">,</span> <img 
src="main3365x.png" alt="c=4,9751219  "  class="math" ><span 
class="ec-lmr-6">; b)</span><img 
src="main3366x.png" alt="a=31,475524  "  class="math" ><span 
class="ec-lmr-6">,</span> <img 
src="main3367x.png" alt="b= 65,691531  "  class="math" ><span 
class="ec-lmr-6">,</span> <img 
src="main3368x.png" alt="c= &minus;272,84382  "  class="math" ><span 
class="ec-lmr-6">,</span>
<img 
src="main3369x.png" alt="d= 208,23621  "  class="math" ><span 
class="ec-lmr-6">.</span>
                                                                       <img 
src="main3370x.png" alt="&#x2662; "  class="math" >
   </div>
                                                                          

                                                                          
   <!--l. 863--><div class="crosslinks"><p class="noindent"><a 
href="mainli11.html#mainli12.html" >Índice</a></p></div>
<!--l. 863--><p class="indent" >   <a 
 id="tailmainse32.html"></a>   
<div class="panel panel-default">
	    <div class="panel-body">
	    	<div class="row">
	    	<div class="col-md-3">
   	   <ul class="list-unstyled">
				<li>Livro
				<ul class="list-unstyled">
	  				<li><a href="https://github.com/livroscolaborativos/CalculoNumerico/blob/master/main.pdf" target="_blank">Versão PDF</a></li>
	  				<li><a 	href="main.html">Versão HTML*</a></li>
	  				<li><a href="main.epub" target="_blank">Versão EPUB*</a></li>		  			       
	  				<li><a href="slide.pdf" target="_blank">Versão Slides*</a></li>
	  				<li><a href="https://github.com/livroscolaborativos/CalculoNumerico" target="_blank">Repositório</a></li>
	  				<li><a href="https://groups.google.com/forum/#!forum/livro_colaborativo">Lista de Discussão</a></li>
				</ul>
      		</li>
      		</ul>
      		</div>
      		<div class="col-md-3">
      		<ul class="list-unstyled">
      		<li>Projeto
				<ul class="list-unstyled">
	  				<li><a href="../index.html">Página Inicial</a></li>
	  				<li><a href="../colabore.html">Colabore</a></li>
	  				<li><a href="../organizadores.html">Organizadores</a></li>
	  				<li><a href="../derivados.html">Trabalhos Derivados</a></li>
				</ul>
      		</li>
    			</ul>
    			</div>
	     		<div class="col-md-3">
      		<ul class="list-unstyled">
      		<li>IME - UFRGS
				<ul class="list-unstyled">
	  				<li><a href="http://www.ufrgs.br/mat" target="_blank">Página do IME</a></li>
	  				<li><a href="http://www.ufrgs.br" target="_blank">Página da UFRGS</a></li>
				</ul>
      		</li>
    			</ul>
    			</div>
  			</div>
  			<p style="font-size: small;">* Os formatos HTML, EPUB e Slides podem estar desatualizados. Para ver a última atualização,
  			veja o formato principal <a href="https://github.com/livroscolaborativos/CalculoNumerico/blob/master/main.pdf" target="_blank">PDF</a>.
 
     </div>
     <div class="panel-footer">
	 <div class="row">
				<img src="../favicon.ico" alt="UFRGS"> UFRGS - IME - Cálculo Numérico - Um Livro Colaborativo. 
				Contato: <a href="mailto:livroscolaborativos@gmail.com" target="_top">livroscolaborativos@gmail.com</a>.
      </div>
      </div>
</div>

</div></div>

</body>
</html>
 
